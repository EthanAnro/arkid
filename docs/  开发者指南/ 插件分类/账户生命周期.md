## 功能介绍
账号生命周期，用于处理账户创建，变更，禁用等过程中账户属性相关的逻辑，插件开发者可以根据需要灵活地添加自己的逻辑

## 实现思路

* ArkID核心提供接口创建和更新定时任务: **arkid.core.tasks.tasks.account_life_periodic_task**
```python linenums="1"
@api.put(
    "/tenant/{tenant_id}/account_life_crontab/",
    tags=["账号生命周期"],
    auth=None,
    response=AccountLifeCrontabOut,
)
@operation(AccountLifeCrontabOut)
def update_account_life_crontab(
    request, tenant_id: str, data: AccountLifeCrontabSchema
):
    """更新账号生命周期定时任务配置"""
    crontab = AccountLifeCrontab.valid_objects.filter(tenant=request.tenant).first()
    if not crontab:
        crontab = AccountLifeCrontab.valid_objects.create(
            tenant=request.tenant, config=data.dict()
        )
    else:
        crontab.config = data.dict()
        crontab.save()
    update_or_create_periodic_task(crontab)
    return {"data": crontab.config}
```
* 定时任务运行时会发送**ACCOUNT_LIFE_PERIODIC_TASK**事件
```python linenums="1"
@app.task(bind=True)
def account_life_periodic_task(self, config_id, *args, **kwargs):
    account_life_crontab = AccountLifeCrontab.valid_objects.get(id=config_id)
    dispatch_event(
        Event(
            tag=ACCOUNT_LIFE_PERIODIC_TASK,
            tenant=account_life_crontab.tenant,
            data=account_life_crontab,
        )
    )
```
* 插件基类中会监听这个事件，在事件处理函数[periodic_task_event_handler](#arkid.core.extension.account_life.AccountLifeExtension.periodic_task_event_handler)中调用抽象方法[periodic_task](#arkid.core.extension.account_life.AccountLifeExtension.periodic_task)
* 具体插件中覆盖抽象方法[periodic_task](#arkid.core.extension.account_life.AccountLifeExtension.periodic_task)实现具体的逻辑

## 抽象方法
* [periodic_task](#arkid.core.extension.account_life.AccountLifeExtension.periodic_task)
## 基类定义

::: arkid.core.extension.account_life.AccountLifeExtension
    rendering:
        show_source: true
    
## 示例

::: extension_root.com_longgui_account_life_arkid.AccountLifeArkIDExtension
    rendering:
        show_source: true
        