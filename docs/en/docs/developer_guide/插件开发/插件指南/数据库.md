# Database

## Customize the data table

Plug-ins can have their own data tables, simply by creating models. Py files in the root directory, written in the Django ORM standard.

Plug-in database version updates also follow Django's principles, and developers need to run ** makemigrations ** them themselves.

Migrate runs automatically before the plug-in is loaded

```py title='models.py'
from django.db import models
from arkid.core.translation import gettext_default as _
from django.apps import AppConfig

app_label = "com_longgui_case"

class CaseApp(AppConfig):
    name = app_label
    
class CaseModel(models.Model):
    class Meta:
        app_label = app_label
    
    nickname = models.CharField(verbose_name=_('nickname', '昵称'), max_length=128)
```
!!! Info "Prompt"

    


## Extended kernel data table

The data table defined in the arkid. Core. Models, which inherits from the ExtendModel class, is the model that can be directly extended by default.

The model classes recommended for extension are:

* [Arkid. Core. Models. Tenant] (././Reference Document/Datasheet Definition/# arkid. Core. Models. Tenant)
* [Arkid. Core. Models. User] (././Reference Document/Datasheet Definition/# arkid. Core. Models. User)
* [Arkid. Core. Models. UserGroup] (././Reference Document/Datasheet Definition/# arkid. Core. Models. UserGroup)
* [Arkid. Core. Models. App] (././Reference Document/Datasheet Definition/# arkid. Core. Models. App)
* [Arkid. Core. Models. AppGroup] (././Reference Document/Datasheet Definition/# arkid. Core. Models. AppGroup)

In the plug-in, define a model whose foreign key is the above classes. To facilitate this operation, ** arkid.core.models ** these abstract classes have been defined in and can be inherited directly.

* [Arkid. Core. Expand. TenantExpandAbstract] (././Reference Document/Datasheet Definition/# arkid. Core. Models. TenantE xpandAbstract)
* [Arkid. Core. Expand. User ExpandAbstract] (././Reference Document/Datasheet Definition/# arkid. Core. Models. User ExpandAbstract)
* [Arkid. Core. Expand. UserGroup ExpandAbstract] (././Reference Document/Datasheet Definition/# arkid. Models. Expand. UserGroup ExpandAbstract)
* [Arkid. Core. Expand. App ExpandAbstract] (././Reference Document/Datasheet Definition/# arkid. Core. Models. App ExpandAbstract)
* [Arkid. Core. Expand. App Group ExpandAbstract] (././Reference Document/Datasheet Definition/# arkid. Models. Expand. App Group ExpandAbstract)

After defining the model, you need to call the **[ arkid.core.extension.Extension.register_extend_field ]()** registration, and then you can directly query, save, and delete the operation

* ** Inquire **: {model}.expand_objects
* ** Create or modify **: {model}.save()
* ** Delete **: {model}.delete()

```py title='models.py'
from django.db import models
from arkid.core.expand import create_expand_abstract_model
from arkid.core.translation import gettext_default as _
from django.apps import AppConfig
from arkid.core.models import UserExpandAbstract

app_label = "com_longgui_case"

class LongguiCaseAppConfig(AppConfig):
    name = app_label
    
class CaseUser(UserExpandAbstract):
    class Meta:
        app_label = app_label
    
    nickname = models.CharField(verbose_name=_('nickname', '昵称'), max_length=128)
```

```py title='__init__.py'
from arkid.core import extension 
from arkid.core.translation import gettext_default as _
from arkid.core.models import User
from .models import CaseUser
from typing import List, Optional
from pydantic import Field

package = 'com.longgui.case'

UserSchema = extension.create_extension_schema(
    'UserSchema',
    package,
    fields=[
        ('username', str, Field()),
        ('nickname', Optional[str], Field()),
    ]
)

class CaseExtension(extension.Extension):
    def load(self):
        super().load()
        self.register_extend_field(CaseUser, 'nickname')
        self.register_api('/test/', 'POST', self.post_handler, tenant_path=True)
        self.register_api('/test/', 'GET', self.get_handler, response=List[UserSchema], tenant_path=True)

    def post_handler(self, request, tenant_id:str, data:UserSchema):
        tenant = request.tenant
        user = User()
        user.tenant = tenant
        user.username = data.username
        user.nickname = data.nickname
        user.save()

    def get_handler(self, request, tenant_id:str, ):
        users = User.expand_objects.filter(tenant=request.tenant).all()
        return list(users)
    
extension = CaseExtension(
    package=package,
    description="",
    version='1.0',
    labels='case',
    homepage='https://www.longguikeji.com',
    logo='',
    author='wely',
)
```